---
import { getImage, Image } from "astro:assets"
import Background from "@/assets/events/iwd-26/packages/background.webp"

export interface Props {
  title: string
  benefits: string[]
  imageSrc: ImageMetadata
  imageAlt: string
  price: string
}

const { title, benefits, imageSrc, imageAlt, price } = Astro.props

const optimizedBg = await getImage({ src: Background, format: "webp" })

// Logic for early bird pricing: until March 3, 2026
const currentDate = new Date()
const deadline = new Date("2026-03-04T00:00:00-04:00") // Midnight of March 4
const isEarlyBird = currentDate < deadline
const showEarlyBird = title === "Build Mode" && isEarlyBird
---

<div
  class="rounded-4xl p-6 flex flex-col justify-between h-[320px] w-[320px] md:max-lg:h-[360px] md:max-lg:w-[320px] md:h-[400px] md:w-[500px] lg:max-xl:h-[380px] lg:max-xl:w-[500px] bg-cover bg-center"
  style={`background-image: url(${optimizedBg.src}); box-shadow: 4px 4px 12.1px 2px rgba(0, 0, 0, 0.25);`}
>
  <!-- Card Title -->
  <div class="text-center mb-3 md:mb-4">
    <h3
      class="text-[24px] md:max-lg:text-[28px] md:text-[32px] lg:max-xl:text-[30px] font-bold text-black tracking-tight leading-tight"
    >
      {title}
    </h3>
  </div>

  <!-- Card Content -->
  <div class="flex-1 flex flex-col justify-center items-center">
    <div class="flex items-center gap-6">
      <!-- Left Column - Text List -->
      <div class="w-fit h-fit">
        <ul class="space-y-2 md:space-y-3">
          {
            benefits.map((benefit) => (
              <li class="flex items-center group">
                <span class="text-[16px] md:max-lg:text-[18px] md:text-[22px] lg:max-xl:text-[21px] font-medium text-black leading-tight ">
                  {benefit}
                </span>
              </li>
            ))
          }
        </ul>
      </div>

      <!-- Right Column - Package Image -->
      <div class="flex items-center justify-center flex-shrink-0">
        <div
          class="w-32 h-32 md:max-lg:w-[150px] md:max-lg:h-[150px] md:w-[220px] md:h-[220px] lg:max-xl:w-[180px] lg:max-xl:h-[180px] overflow-hidden"
        >
          <Image
            src={imageSrc}
            alt={imageAlt}
            width={360}
            height={360}
            class="w-full h-full object-contain"
          />
        </div>
      </div>
    </div>
  </div>

  <!-- Price Button -->
  <div class="text-center mt-3 md:mt-2">
    {
      showEarlyBird ? (
        <div class="flex items-center justify-center gap-2 md:gap-4 scale-90 md:scale-100">
          {/* Original Price with X */}
          <div class="relative bg-[#ebb842] text-white px-4 md:px-6 py-2 md:py-3 rounded-full font-bold text-[20px] md:text-[28px] inline-block isolate">
            <span class="text-white">60 Bs</span>
            <div class="absolute inset-0 flex items-center justify-center pointer-events-none select-none">
              <svg
                viewBox="0 0 100 100"
                class="w-full h-full text-[#1976D2] scale-110 drop-shadow-sm"
              >
                <line
                  x1="10"
                  y1="10"
                  x2="90"
                  y2="90"
                  stroke="currentColor"
                  stroke-width="8"
                  stroke-linecap="round"
                />
                <line
                  x1="90"
                  y1="10"
                  x2="10"
                  y2="90"
                  stroke="currentColor"
                  stroke-width="8"
                  stroke-linecap="round"
                />
              </svg>
            </div>
          </div>

          {/* Arrow Icon */}
          <div class="text-[#1976D2]">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path d="M13 5L11.59 6.41L16.17 11H4V13H16.17L11.59 17.59L13 19L20 12L13 5Z" />
            </svg>
          </div>

          {/* New Price */}
          <div class="bg-[#1976D2] text-white px-4 md:px-8 py-2 md:py-3 rounded-full font-bold text-[24px] md:max-lg:text-[28px] md:text-[32px] lg:max-xl:text-[30px] inline-block shadow-lg">
            50 Bs
          </div>
        </div>
      ) : (
        <div class="bg-[#1976D2] text-white px-4 md:px-8 py-2 md:py-3 rounded-full font-bold text-[24px] md:max-lg:text-[28px] md:text-[32px] lg:max-xl:text-[30px] inline-block">
          {price}
        </div>
      )
    }
  </div>
</div>
