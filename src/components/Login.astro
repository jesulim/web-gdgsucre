---
import Avatar from "@/components/Avatar.astro"
import { Button } from "@/components/ui/button"
import { createUserClient } from "@/lib/supabase"

const supabase = await createUserClient(Astro.cookies)
const {
  data: { user },
} = await supabase.auth.getUser()
---

<div class="flex items-center gap-2">
  {user ? (
    <div class="flex items-center gap-3">
      <a href="/account" class="flex items-center hover:opacity-80 transition-opacity">
        <Avatar client:load />
      </a>
      <a href="/api/auth/signout">
        <Button type="button" variant="destructive" class="text-sm">Cerrar sesión</Button>
      </a>
    </div>
  ) : (
    <a href="/api/auth/signin">
      <Button type="button" class="bg-blue-500 text-white hover:bg-blue-600 text-sm">
        Iniciar sesión
      </Button>
    </a>
  )}
</div>