---
import { Button } from "@/components/ui/button"
import { getCurrentUser } from "@/lib/services/profileService"

const { cookies } = Astro
const accessToken = cookies.get("sb-access-token")

const user = accessToken ? await getCurrentUser() : null
---

<div class="flex gap-2 items-center">
  {
    user ? (
      <form action="/api/auth/signout" method="post">
        <Button type="submit" variant="destructive">
          Cerrar sesión
        </Button>
      </form>
    ) : (
      <form action="/api/auth/signin" method="post">
        <Button type="submit">Iniciar sesión</Button>
      </form>
    )
  }
</div>
