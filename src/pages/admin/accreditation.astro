---
import Header from "@/components/Header.astro"
import { AccreditationTable } from "@/components/accreditation/AccreditationTable"
import BaseLayout from "@/layout/BaseLayout.astro"
import { getProfile } from "@/lib/services/profileService"
import { createUserClient } from "@/lib/supabase"

const supabase = await createUserClient(Astro.cookies)
const profile = await getProfile(supabase)

if (!profile?.is_admin) {
  Astro.redirect("/")
}
---

<BaseLayout>
    <Header />
    <main class="mt-20 p-4 lg:p-8">
        <div class="mb-6">
            <div class="flex items-center gap-4 mb-4">
                <a href="/admin" class="text-blue-600 hover:text-blue-800 font-medium">
                    ← Volver al Panel de Administración
                </a>
            </div>
            <h1 class="text-2xl font-bold">Acreditación de Participantes</h1>
            <p class="text-gray-600 mt-2">
                Controla el check-in y entrega de paquetes a los participantes.
            </p>
        </div>
        <AccreditationTable client:visible />
    </main>
</BaseLayout>
